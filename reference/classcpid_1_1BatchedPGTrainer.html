<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>TorchCraftAI: cpid::BatchedPGTrainer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TorchCraftAI
   </div>
   <div id="projectbrief">A bot for machine learning research on StarCraft: Brood War</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacecpid.html">cpid</a></li><li class="navelem"><a class="el" href="classcpid_1_1BatchedPGTrainer.html">BatchedPGTrainer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classcpid_1_1BatchedPGTrainer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">cpid::BatchedPGTrainer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Off policy policy gradient with a critic.  
 <a href="classcpid_1_1BatchedPGTrainer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="policygradienttrainer_8h_source.html">policygradienttrainer.h</a>&gt;</code></p>

<p>Inherits <a class="el" href="classcpid_1_1Trainer.html">cpid::Trainer</a>.</p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0692fe6b66674f34d41f60a316b44864"><td class="memItemLeft" align="right" valign="top">ag::Variant&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1BatchedPGTrainer.html#a0692fe6b66674f34d41f60a316b44864">forward</a> (ag::Variant inp, <a class="el" href="structcpid_1_1Trainer_1_1EpisodeHandle.html">EpisodeHandle</a> const &amp;) override</td></tr>
<tr class="separator:a0692fe6b66674f34d41f60a316b44864"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22b2d79fb4f523e316843ba7a2e33cbf"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1BatchedPGTrainer.html#a22b2d79fb4f523e316843ba7a2e33cbf">update</a> () override</td></tr>
<tr class="separator:a22b2d79fb4f523e316843ba7a2e33cbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29e7f0d5a80d59752393ae87bcbf2453"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1BatchedPGTrainer.html#a29e7f0d5a80d59752393ae87bcbf2453">doOnlineUpdatesInstead</a> ()</td></tr>
<tr class="separator:a29e7f0d5a80d59752393ae87bcbf2453"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68b338681ee36b14aac6566b55aaefa4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1BatchedPGTrainer.html#a68b338681ee36b14aac6566b55aaefa4">episodes</a> ()</td></tr>
<tr class="separator:a68b338681ee36b14aac6566b55aaefa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3534d9dadc20bb9e194e40cebf3344ee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1BatchedPGTrainer.html#a3534d9dadc20bb9e194e40cebf3344ee">BatchedPGTrainer</a> (ag::Container <a class="el" href="classcpid_1_1Trainer.html#a725e7be593702910a92eb8e27b100a73">model</a>, ag::Optimizer <a class="el" href="classcpid_1_1Trainer.html#ad0f87b4190a741893c7050af55ba17f5">optim</a>, std::unique_ptr&lt; <a class="el" href="classcpid_1_1BaseSampler.html">BaseSampler</a> &gt; sampler, double gamma=0.99, int batchSize=10, std::size_t maxBatchSize=50, std::unique_ptr&lt; <a class="el" href="classcpid_1_1AsyncBatcher.html">AsyncBatcher</a> &gt; batcher=nullptr)</td></tr>
<tr class="separator:a3534d9dadc20bb9e194e40cebf3344ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c37fbb26582adba7476567c6a8a5b67"><td class="memItemLeft" align="right" valign="top">virtual std::shared_ptr&lt; <a class="el" href="structcpid_1_1ReplayBufferFrame.html">ReplayBufferFrame</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1BatchedPGTrainer.html#a3c37fbb26582adba7476567c6a8a5b67">makeFrame</a> (ag::Variant trainerOutput, ag::Variant state, float reward) override</td></tr>
<tr class="memdesc:a3c37fbb26582adba7476567c6a8a5b67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contract: the trainer output should be a map with keys: "action" for the taken action "V" for the state value, and "action" for the action probability.  <a href="#a3c37fbb26582adba7476567c6a8a5b67">More...</a><br /></td></tr>
<tr class="separator:a3c37fbb26582adba7476567c6a8a5b67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ffb5fc65bdaaa6bf1873c68ad6d78e0"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classcpid_1_1Evaluator.html">Evaluator</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1BatchedPGTrainer.html#a5ffb5fc65bdaaa6bf1873c68ad6d78e0">makeEvaluator</a> (size_t, std::unique_ptr&lt; <a class="el" href="classcpid_1_1BaseSampler.html">BaseSampler</a> &gt; sampler=std::make_unique&lt; <a class="el" href="classcpid_1_1DiscreteMaxSampler.html">DiscreteMaxSampler</a> &gt;()) override</td></tr>
<tr class="separator:a5ffb5fc65bdaaa6bf1873c68ad6d78e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classcpid_1_1Trainer"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classcpid_1_1Trainer')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classcpid_1_1Trainer.html">cpid::Trainer</a></td></tr>
<tr class="memitem:a37608aa8e5dd1efcbf367ab29a3b67c2 inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a37608aa8e5dd1efcbf367ab29a3b67c2">Trainer</a> (ag::Container <a class="el" href="classcpid_1_1Trainer.html#a725e7be593702910a92eb8e27b100a73">model</a>, ag::Optimizer <a class="el" href="classcpid_1_1Trainer.html#ad0f87b4190a741893c7050af55ba17f5">optim</a>, std::unique_ptr&lt; <a class="el" href="classcpid_1_1BaseSampler.html">BaseSampler</a> &gt;, std::unique_ptr&lt; <a class="el" href="classcpid_1_1AsyncBatcher.html">AsyncBatcher</a> &gt; batcher=nullptr)</td></tr>
<tr class="separator:a37608aa8e5dd1efcbf367ab29a3b67c2 inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a904adcd51362a7596b58f686a789821a inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">ag::Variant&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a904adcd51362a7596b58f686a789821a">forwardUnbatched</a> (ag::Variant in, ag::Container <a class="el" href="classcpid_1_1Trainer.html#a725e7be593702910a92eb8e27b100a73">model</a>=nullptr)</td></tr>
<tr class="memdesc:a904adcd51362a7596b58f686a789821a inherit pub_methods_classcpid_1_1Trainer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convenience function when one need to forward a single input.  <a href="#a904adcd51362a7596b58f686a789821a">More...</a><br /></td></tr>
<tr class="separator:a904adcd51362a7596b58f686a789821a inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bc4556a33e42daf08c8ccb4016606ff inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a6bc4556a33e42daf08c8ccb4016606ff">~Trainer</a> ()=default</td></tr>
<tr class="separator:a6bc4556a33e42daf08c8ccb4016606ff inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46411f6993a37805f4f5bfbbd06b0983 inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a46411f6993a37805f4f5bfbbd06b0983">setTrain</a> (bool=true)</td></tr>
<tr class="separator:a46411f6993a37805f4f5bfbbd06b0983 inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfcece21d57d4713a5996e10e26abc4c inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#abfcece21d57d4713a5996e10e26abc4c">isTrain</a> () const </td></tr>
<tr class="separator:abfcece21d57d4713a5996e10e26abc4c inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dca79bd5abc3956c02f0a40badfe3bb inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">ag::Variant&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a3dca79bd5abc3956c02f0a40badfe3bb">sample</a> (ag::Variant in)</td></tr>
<tr class="memdesc:a3dca79bd5abc3956c02f0a40badfe3bb inherit pub_methods_classcpid_1_1Trainer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sample using the class' sampler.  <a href="#a3dca79bd5abc3956c02f0a40badfe3bb">More...</a><br /></td></tr>
<tr class="separator:a3dca79bd5abc3956c02f0a40badfe3bb inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a725e7be593702910a92eb8e27b100a73 inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">ag::Container&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a725e7be593702910a92eb8e27b100a73">model</a> () const </td></tr>
<tr class="separator:a725e7be593702910a92eb8e27b100a73 inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0f87b4190a741893c7050af55ba17f5 inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">ag::Optimizer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#ad0f87b4190a741893c7050af55ba17f5">optim</a> () const </td></tr>
<tr class="separator:ad0f87b4190a741893c7050af55ba17f5 inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8993df403c7a3fab0cd4b43d5c33c91f inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcpid_1_1ReplayBuffer.html">ReplayBuffer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a8993df403c7a3fab0cd4b43d5c33c91f">replayBuffer</a> ()</td></tr>
<tr class="separator:a8993df403c7a3fab0cd4b43d5c33c91f inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8859cc72adf2c103aeafcdecbf89951 inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#ae8859cc72adf2c103aeafcdecbf89951">setDone</a> (bool=true)</td></tr>
<tr class="separator:ae8859cc72adf2c103aeafcdecbf89951 inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dfdbf82bb3d08a33cc5262a842d8ed2 inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a8dfdbf82bb3d08a33cc5262a842d8ed2">isDone</a> () const </td></tr>
<tr class="separator:a8dfdbf82bb3d08a33cc5262a842d8ed2 inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad412968ea357bfe7db2f8b1829c91354 inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#ad412968ea357bfe7db2f8b1829c91354">step</a> (<a class="el" href="structcpid_1_1Trainer_1_1EpisodeHandle.html">EpisodeHandle</a> const &amp;, std::shared_ptr&lt; <a class="el" href="structcpid_1_1ReplayBufferFrame.html">ReplayBufferFrame</a> &gt; v, bool <a class="el" href="classcpid_1_1Trainer.html#a8dfdbf82bb3d08a33cc5262a842d8ed2">isDone</a>=false)</td></tr>
<tr class="separator:ad412968ea357bfe7db2f8b1829c91354 inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1df3cb2891fa6a56f0368b4871b58258 inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="structcpid_1_1Trainer_1_1EpisodeHandle.html">EpisodeHandle</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a1df3cb2891fa6a56f0368b4871b58258">startEpisode</a> ()</td></tr>
<tr class="memdesc:a1df3cb2891fa6a56f0368b4871b58258 inherit pub_methods_classcpid_1_1Trainer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if succeeded to register an episode, and false otherwise.  <a href="#a1df3cb2891fa6a56f0368b4871b58258">More...</a><br /></td></tr>
<tr class="separator:a1df3cb2891fa6a56f0368b4871b58258 inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afabe12b24393cb8b3d60bcf528f4285d inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#afabe12b24393cb8b3d60bcf528f4285d">forceStopEpisode</a> (<a class="el" href="structcpid_1_1Trainer_1_1EpisodeHandle.html">EpisodeHandle</a> const &amp;)</td></tr>
<tr class="separator:afabe12b24393cb8b3d60bcf528f4285d inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5d9c9f365face81e4d446be52b69a6d inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#ad5d9c9f365face81e4d446be52b69a6d">isActive</a> (<a class="el" href="structcpid_1_1Trainer_1_1EpisodeHandle.html">EpisodeHandle</a> const &amp;)</td></tr>
<tr class="separator:ad5d9c9f365face81e4d446be52b69a6d inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae83e7aa739689681176898611413f6f3 inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#ae83e7aa739689681176898611413f6f3">reset</a> ()</td></tr>
<tr class="memdesc:ae83e7aa739689681176898611413f6f3 inherit pub_methods_classcpid_1_1Trainer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Releases all the worker threads so that they can be joined.  <a href="#ae83e7aa739689681176898611413f6f3">More...</a><br /></td></tr>
<tr class="separator:ae83e7aa739689681176898611413f6f3 inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade59a4dc3da50591fb071c69c48a9cb4 inherit pub_methods_classcpid_1_1Trainer"><td class="memTemplParams" colspan="2">template&lt;class Archive &gt; </td></tr>
<tr class="memitem:ade59a4dc3da50591fb071c69c48a9cb4 inherit pub_methods_classcpid_1_1Trainer"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#ade59a4dc3da50591fb071c69c48a9cb4">save</a> (Archive &amp;ar) const </td></tr>
<tr class="separator:ade59a4dc3da50591fb071c69c48a9cb4 inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65e055366d3802e249ce31e7754026c8 inherit pub_methods_classcpid_1_1Trainer"><td class="memTemplParams" colspan="2">template&lt;class Archive &gt; </td></tr>
<tr class="memitem:a65e055366d3802e249ce31e7754026c8 inherit pub_methods_classcpid_1_1Trainer"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a65e055366d3802e249ce31e7754026c8">load</a> (Archive &amp;ar)</td></tr>
<tr class="separator:a65e055366d3802e249ce31e7754026c8 inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1a4616e3f22e62b3a044d0a619ed36c inherit pub_methods_classcpid_1_1Trainer"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:aa1a4616e3f22e62b3a044d0a619ed36c inherit pub_methods_classcpid_1_1Trainer"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#aa1a4616e3f22e62b3a044d0a619ed36c">is</a> () const </td></tr>
<tr class="separator:aa1a4616e3f22e62b3a044d0a619ed36c inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb5c92955ea28cfe86a1df4519f940a5 inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcpid_1_1Trainer.html">Trainer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#afb5c92955ea28cfe86a1df4519f940a5">setMetricsContext</a> (std::shared_ptr&lt; <a class="el" href="classcpid_1_1MetricsContext.html">MetricsContext</a> &gt; context)</td></tr>
<tr class="separator:afb5c92955ea28cfe86a1df4519f940a5 inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26ec4c8224e9e5e6d3d6b729bd523048 inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classcpid_1_1MetricsContext.html">MetricsContext</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a26ec4c8224e9e5e6d3d6b729bd523048">metricsContext</a> () const </td></tr>
<tr class="separator:a26ec4c8224e9e5e6d3d6b729bd523048 inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22719e06d1f96996a23d390e8a364d1a inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a22719e06d1f96996a23d390e8a364d1a">TORCH_ARG</a> (float, noiseStd)</td></tr>
<tr class="separator:a22719e06d1f96996a23d390e8a364d1a inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fe43560542a0f92bad515fef297f39b inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a1fe43560542a0f92bad515fef297f39b">TORCH_ARG</a> (bool, continuousActions)</td></tr>
<tr class="separator:a1fe43560542a0f92bad515fef297f39b inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4abf195d7b982393dc6c5a06e634ef88 inherit pub_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a4abf195d7b982393dc6c5a06e634ef88">setBatcher</a> (std::unique_ptr&lt; <a class="el" href="classcpid_1_1AsyncBatcher.html">AsyncBatcher</a> &gt; batcher)</td></tr>
<tr class="separator:a4abf195d7b982393dc6c5a06e634ef88 inherit pub_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a90bca6ea88168011aa5c81020dbda597"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1BatchedPGTrainer.html#a90bca6ea88168011aa5c81020dbda597">stepEpisode</a> (<a class="el" href="namespacecpid.html#aa8cf44de209adffc9e01a1d11376beae">GameUID</a> const &amp;, <a class="el" href="namespacecpid.html#a202d873acf77413b254487acf07bfe0b">EpisodeKey</a> const &amp;, <a class="el" href="classcpid_1_1ReplayBuffer.html#a42603e043c83dd89036b8230d1adca74">ReplayBuffer::Episode</a> &amp;) override</td></tr>
<tr class="separator:a90bca6ea88168011aa5c81020dbda597"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classcpid_1_1Trainer"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classcpid_1_1Trainer')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classcpid_1_1Trainer.html">cpid::Trainer</a></td></tr>
<tr class="memitem:a3c7c6b13fa4361fc4075268d1a7ffa40 inherit pro_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a3c7c6b13fa4361fc4075268d1a7ffa40">stepFrame</a> (<a class="el" href="namespacecpid.html#aa8cf44de209adffc9e01a1d11376beae">GameUID</a> const &amp;, <a class="el" href="namespacecpid.html#a202d873acf77413b254487acf07bfe0b">EpisodeKey</a> const &amp;, <a class="el" href="classcpid_1_1ReplayBuffer.html#a42603e043c83dd89036b8230d1adca74">ReplayBuffer::Episode</a> &amp;)</td></tr>
<tr class="separator:a3c7c6b13fa4361fc4075268d1a7ffa40 inherit pro_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefb741f9671366397b8b43f0d8e1a884 inherit pro_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#aefb741f9671366397b8b43f0d8e1a884">stepGame</a> (<a class="el" href="namespacecpid.html#aa8cf44de209adffc9e01a1d11376beae">GameUID</a> const &amp;game)</td></tr>
<tr class="separator:aefb741f9671366397b8b43f0d8e1a884 inherit pro_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55f02f63709e0fad3f548a4d87d5171a inherit pro_methods_classcpid_1_1Trainer"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a55f02f63709e0fad3f548a4d87d5171a inherit pro_methods_classcpid_1_1Trainer"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; T const * &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a55f02f63709e0fad3f548a4d87d5171a">cast</a> (<a class="el" href="classcpid_1_1ReplayBuffer.html#a42603e043c83dd89036b8230d1adca74">ReplayBuffer::Episode</a> const &amp;e)</td></tr>
<tr class="separator:a55f02f63709e0fad3f548a4d87d5171a inherit pro_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_types_classcpid_1_1Trainer"><td colspan="2" onclick="javascript:toggleInherit('pro_types_classcpid_1_1Trainer')"><img src="closed.png" alt="-"/>&#160;Protected Types inherited from <a class="el" href="classcpid_1_1Trainer.html">cpid::Trainer</a></td></tr>
<tr class="memitem:a775a2b5afa4cb841f48366602286544b inherit pro_types_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a775a2b5afa4cb841f48366602286544b">ForwardFunction</a> = std::function&lt; ag::Variant(ag::Variant, <a class="el" href="structcpid_1_1Trainer_1_1EpisodeHandle.html">EpisodeHandle</a> const &amp;)&gt;</td></tr>
<tr class="separator:a775a2b5afa4cb841f48366602286544b inherit pro_types_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_static_methods_classcpid_1_1Trainer"><td colspan="2" onclick="javascript:toggleInherit('pro_static_methods_classcpid_1_1Trainer')"><img src="closed.png" alt="-"/>&#160;Static Protected Member Functions inherited from <a class="el" href="classcpid_1_1Trainer.html">cpid::Trainer</a></td></tr>
<tr class="memitem:a5a08fcc8beac1528491bca7706832f0c inherit pro_static_methods_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">static std::shared_ptr&lt; <a class="el" href="classcpid_1_1Evaluator.html">Evaluator</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a5a08fcc8beac1528491bca7706832f0c">evaluatorFactory</a> (ag::Container <a class="el" href="classcpid_1_1Trainer.html#a725e7be593702910a92eb8e27b100a73">model</a>, std::unique_ptr&lt; <a class="el" href="classcpid_1_1BaseSampler.html">BaseSampler</a> &gt; s, size_t n, <a class="el" href="classcpid_1_1Trainer.html#a775a2b5afa4cb841f48366602286544b">ForwardFunction</a> func)</td></tr>
<tr class="separator:a5a08fcc8beac1528491bca7706832f0c inherit pro_static_methods_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classcpid_1_1Trainer"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classcpid_1_1Trainer')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classcpid_1_1Trainer.html">cpid::Trainer</a></td></tr>
<tr class="memitem:a106ea9ef0d96566aa2908a17da10ea6e inherit pro_attribs_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">ag::Container&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a106ea9ef0d96566aa2908a17da10ea6e">model_</a></td></tr>
<tr class="separator:a106ea9ef0d96566aa2908a17da10ea6e inherit pro_attribs_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48445f0e117aaba61c32e0cbf317d253 inherit pro_attribs_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">ag::Optimizer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a48445f0e117aaba61c32e0cbf317d253">optim_</a></td></tr>
<tr class="separator:a48445f0e117aaba61c32e0cbf317d253 inherit pro_attribs_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f400292c7a5e91cb5bb52b62f0b4098 inherit pro_attribs_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classcpid_1_1MetricsContext.html">MetricsContext</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a6f400292c7a5e91cb5bb52b62f0b4098">metricsContext_</a></td></tr>
<tr class="separator:a6f400292c7a5e91cb5bb52b62f0b4098 inherit pro_attribs_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b3802f43181cbde20fd53e85e8608d2 inherit pro_attribs_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcpid_1_1ReplayBuffer.html">ReplayBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a9b3802f43181cbde20fd53e85e8608d2">replayer_</a></td></tr>
<tr class="separator:a9b3802f43181cbde20fd53e85e8608d2 inherit pro_attribs_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b21618c4a1a9317170989568cf26094 inherit pro_attribs_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a0b21618c4a1a9317170989568cf26094">train_</a> = true</td></tr>
<tr class="separator:a0b21618c4a1a9317170989568cf26094 inherit pro_attribs_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42648cbdd28b5c06e586c3c1514a8d35 inherit pro_attribs_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">std::atomic&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a42648cbdd28b5c06e586c3c1514a8d35">done_</a> {false}</td></tr>
<tr class="separator:a42648cbdd28b5c06e586c3c1514a8d35 inherit pro_attribs_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e20e529ab419056f872fa81e91dc414 inherit pro_attribs_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">std::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a8e20e529ab419056f872fa81e91dc414">modelWriteMutex_</a></td></tr>
<tr class="separator:a8e20e529ab419056f872fa81e91dc414 inherit pro_attribs_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e2ea4becd910a7324bf263682f5557a inherit pro_attribs_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">std::shared_timed_mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a1e2ea4becd910a7324bf263682f5557a">activeMapMutex_</a></td></tr>
<tr class="separator:a1e2ea4becd910a7324bf263682f5557a inherit pro_attribs_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ba084b7f468011c33f41799c505d572 inherit pro_attribs_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classcpid_1_1BaseSampler.html">BaseSampler</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a3ba084b7f468011c33f41799c505d572">sampler_</a></td></tr>
<tr class="separator:a3ba084b7f468011c33f41799c505d572 inherit pro_attribs_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9944c18f683d20c58d2215dddcc02748 inherit pro_attribs_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classcpid_1_1AsyncBatcher.html">AsyncBatcher</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a9944c18f683d20c58d2215dddcc02748">batcher_</a></td></tr>
<tr class="separator:a9944c18f683d20c58d2215dddcc02748 inherit pro_attribs_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fb39ecbab796b12bddf4cc2fc20a454 inherit pro_attribs_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="structcpid_1_1HandleGuard.html">HandleGuard</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#a3fb39ecbab796b12bddf4cc2fc20a454">epGuard_</a></td></tr>
<tr class="separator:a3fb39ecbab796b12bddf4cc2fc20a454 inherit pro_attribs_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad8d5a01d29393aa8549c4dce022dff6 inherit pro_attribs_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcpid_1_1ReplayBuffer.html#a284cfd916c6bc35daa833c665ee25ccb">ReplayBuffer::UIDKeyStore</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#aad8d5a01d29393aa8549c4dce022dff6">actives_</a></td></tr>
<tr class="separator:aad8d5a01d29393aa8549c4dce022dff6 inherit pro_attribs_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_static_attribs_classcpid_1_1Trainer"><td colspan="2" onclick="javascript:toggleInherit('pro_static_attribs_classcpid_1_1Trainer')"><img src="closed.png" alt="-"/>&#160;Static Protected Attributes inherited from <a class="el" href="classcpid_1_1Trainer.html">cpid::Trainer</a></td></tr>
<tr class="memitem:aa05722c92b009206ce29999a4c687ab8 inherit pro_static_attribs_classcpid_1_1Trainer"><td class="memItemLeft" align="right" valign="top">static constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcpid_1_1Trainer.html#aa05722c92b009206ce29999a4c687ab8">kFwdMetricsSubsampling</a> = 0.1</td></tr>
<tr class="memdesc:aa05722c92b009206ce29999a4c687ab8 inherit pro_static_attribs_classcpid_1_1Trainer"><td class="mdescLeft">&#160;</td><td class="mdescRight">We subsample kFwdMetricsSubsampling of the <a class="el" href="classcpid_1_1Trainer.html#ab88ff7def681074e1a2423fd46f94485">forward()</a> events when measuring their duration.  <a href="#aa05722c92b009206ce29999a4c687ab8">More...</a><br /></td></tr>
<tr class="separator:aa05722c92b009206ce29999a4c687ab8 inherit pro_static_attribs_classcpid_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Off policy policy gradient with a critic. </p>
<p>This <a class="el" href="classcpid_1_1Trainer.html" title="The Trainer should be shared amongst multiple different nodes, and attached to a single Module...">Trainer</a> implements two modes:</p><ul>
<li>Online: It does 1 update with the given batch size per node whenever it gets an episode. Therefore, one episode will always be new and the others will be from the replay buffer. THIS MODE IS UNTESTED</li>
<li>Offline: Many threads are assumed to generate episodes in the background, and it does updates in a seperate background thread. In both modes, it will first update on new episodes at least once before moving to sample from the replay buffer. If more episodes are generated than it can update, it will block until the next update. When the replaybuffer of episodes it has already updated over reaches maxBatchSize, it will remove the oldest episode it's seen.</li>
</ul>
<p>Replayer format: state, action, p(action), reward</p>
<p>Model output: Probability vector over actions: 1-dim Vector Critic's value estimate: Double </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a3534d9dadc20bb9e194e40cebf3344ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cpid::BatchedPGTrainer::BatchedPGTrainer </td>
          <td>(</td>
          <td class="paramtype">ag::Container&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ag::Optimizer&#160;</td>
          <td class="paramname"><em>optim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; <a class="el" href="classcpid_1_1BaseSampler.html">BaseSampler</a> &gt;&#160;</td>
          <td class="paramname"><em>sampler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gamma</em> = <code>0.99</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>batchSize</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>maxBatchSize</em> = <code>50</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; <a class="el" href="classcpid_1_1AsyncBatcher.html">AsyncBatcher</a> &gt;&#160;</td>
          <td class="paramname"><em>batcher</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a29e7f0d5a80d59752393ae87bcbf2453"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cpid::BatchedPGTrainer::doOnlineUpdatesInstead </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a68b338681ee36b14aac6566b55aaefa4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int cpid::BatchedPGTrainer::episodes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a0692fe6b66674f34d41f60a316b44864"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ag::Variant cpid::BatchedPGTrainer::forward </td>
          <td>(</td>
          <td class="paramtype">ag::Variant&#160;</td>
          <td class="paramname"><em>inp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcpid_1_1Trainer_1_1EpisodeHandle.html">EpisodeHandle</a> const &amp;&#160;</td>
          <td class="paramname"><em>handle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classcpid_1_1Trainer.html#ab88ff7def681074e1a2423fd46f94485">cpid::Trainer</a>.</p>

</div>
</div>
<a class="anchor" id="a5ffb5fc65bdaaa6bf1873c68ad6d78e0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt; <a class="el" href="classcpid_1_1Evaluator.html">Evaluator</a> &gt; cpid::BatchedPGTrainer::makeEvaluator </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; <a class="el" href="classcpid_1_1BaseSampler.html">BaseSampler</a> &gt;&#160;</td>
          <td class="paramname"><em>sampler</em> = <code>std::make_unique&lt;<a class="el" href="classcpid_1_1DiscreteMaxSampler.html">DiscreteMaxSampler</a>&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classcpid_1_1Trainer.html#a00e5fdba895365a7fa21fe7e0f678789">cpid::Trainer</a>.</p>

</div>
</div>
<a class="anchor" id="a3c37fbb26582adba7476567c6a8a5b67"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt; <a class="el" href="structcpid_1_1ReplayBufferFrame.html">ReplayBufferFrame</a> &gt; cpid::BatchedPGTrainer::makeFrame </td>
          <td>(</td>
          <td class="paramtype">ag::Variant&#160;</td>
          <td class="paramname"><em>trainerOutput</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ag::Variant&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>reward</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Contract: the trainer output should be a map with keys: "action" for the taken action "V" for the state value, and "action" for the action probability. </p>

<p>Implements <a class="el" href="classcpid_1_1Trainer.html#a474ff88ec1452e37a67eb5414f27dcea">cpid::Trainer</a>.</p>

</div>
</div>
<a class="anchor" id="a90bca6ea88168011aa5c81020dbda597"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cpid::BatchedPGTrainer::stepEpisode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacecpid.html#aa8cf44de209adffc9e01a1d11376beae">GameUID</a> const &amp;&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecpid.html#a202d873acf77413b254487acf07bfe0b">EpisodeKey</a> const &amp;&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcpid_1_1ReplayBuffer.html#a42603e043c83dd89036b8230d1adca74">ReplayBuffer::Episode</a> &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classcpid_1_1Trainer.html#a16d449a41e394828439c9805143b0628">cpid::Trainer</a>.</p>

</div>
</div>
<a class="anchor" id="a22b2d79fb4f523e316843ba7a2e33cbf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool cpid::BatchedPGTrainer::update </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classcpid_1_1Trainer.html#accc38f8679853d75e431ac0ba7b6e089">cpid::Trainer</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>cpid/<a class="el" href="policygradienttrainer_8h_source.html">policygradienttrainer.h</a></li>
<li>cpid/policygradienttrainer.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 17 2019 18:31:56 for TorchCraftAI by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
