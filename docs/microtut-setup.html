<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Micromanagement Scenarios Tutorial · TorchCraftAI</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;We train the model introduced in the &lt;a href=&quot;/TorchCraftAI/docs/microtut-model.html&quot;&gt;previous_section&lt;/a&gt; using Evolution Strategies.&lt;/p&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Micromanagement Scenarios Tutorial · TorchCraftAI"/><meta property="og:type" content="website"/><meta property="og:url" content="https://torchcraft.github.io/TorchCraftAI/index.html"/><meta property="og:description" content="&lt;p&gt;We train the model introduced in the &lt;a href=&quot;/TorchCraftAI/docs/microtut-model.html&quot;&gt;previous_section&lt;/a&gt; using Evolution Strategies.&lt;/p&gt;
"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://torchcraft.github.io/TorchCraftAI/img/tclogolinesmall.png"/><link rel="shortcut icon" href="/TorchCraftAI/img/favicon/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://torchcraft.github.io/TorchCraftAI/blog/atom.xml" title="TorchCraftAI Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://torchcraft.github.io/TorchCraftAI/blog/feed.xml" title="TorchCraftAI Blog RSS Feed"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/js/code-blocks-buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script><link rel="stylesheet" href="/TorchCraftAI/css/main.css"/><script src="/TorchCraftAI/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/TorchCraftAI/"><img class="logo" src="/TorchCraftAI/img/tclogosqlightgrey.png" alt="TorchCraftAI"/></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/TorchCraftAI/docs/bptut-intro.html" target="_self">Tutorials</a></li><li class=""><a href="/TorchCraftAI/reference/index.html" target="_self">API</a></li><li class=""><a href="/TorchCraftAI/blog/" target="_self">Blog</a></li><li class=""><a href="https://github.com/TorchCraft/TorchCraftAI" target="_blank">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Tutorial - Micro-Manamagent</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Getting Started</h3><ul class=""><li class="navListItem"><a class="navItem" href="/TorchCraftAI/docs/install-linux.html">Installation (Linux)</a></li><li class="navListItem"><a class="navItem" href="/TorchCraftAI/docs/install-windows.html">Installation (Windows)</a></li><li class="navListItem"><a class="navItem" href="/TorchCraftAI/docs/install-macos.html">Installation (macOS)</a></li><li class="navListItem"><a class="navItem" href="/TorchCraftAI/docs/play-games.html">Play games with CherryPi</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">TorchCraftAI</h3><ul class=""><li class="navListItem"><a class="navItem" href="/TorchCraftAI/docs/overview.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/TorchCraftAI/docs/architecture.html">System Architecture</a></li><li class="navListItem"><a class="navItem" href="/TorchCraftAI/docs/core-abstractions.html">Core Abstractions</a></li><li class="navListItem"><a class="navItem" href="/TorchCraftAI/docs/modules.html">Modules Overview</a></li><li class="navListItem"><a class="navItem" href="/TorchCraftAI/docs/module-training.html">Module Training Blueprints</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Tutorial - Building Placement</h3><ul class=""><li class="navListItem"><a class="navItem" href="/TorchCraftAI/docs/bptut-intro.html">Building Placement Intro</a></li><li class="navListItem"><a class="navItem" href="/TorchCraftAI/docs/bptut-model.html">Neural Network Architecture</a></li><li class="navListItem"><a class="navItem" href="/TorchCraftAI/docs/bptut-supervised.html">Supervised Learning</a></li><li class="navListItem"><a class="navItem" href="/TorchCraftAI/docs/bptut-rl.html">Reinforcement Learning</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Tutorial - Micro-Manamagent</h3><ul class=""><li class="navListItem"><a class="navItem" href="/TorchCraftAI/docs/microtut-intro.html">Micromanagement Intro</a></li><li class="navListItem"><a class="navItem" href="/TorchCraftAI/docs/microtut-model.html">Model</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/TorchCraftAI/docs/microtut-setup.html">Training Setup</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Micromanagement Scenarios Tutorial</h1></header><article><div><span><p>We train the model introduced in the <a href="/TorchCraftAI/docs/microtut-model.html">previous_section</a> using Evolution Strategies.
To make training more feasible, we choose to do some reward shaping to encourage our model to learn.
We show that we are able to learn interesting behaviors in a variety of different situations.
To try some of these yourself, check out how the model learns to spread units out in the 10mu_5co scenario, or how it learns to kite in the 1vu_1zl scenario.</p>
<h2><a class="anchor" aria-hidden="true" id="evolution-strategies"></a><a href="#evolution-strategies" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Evolution Strategies</h2>
<p><a href="https://blog.openai.com/evolution-strategies/">Evolution Strategies</a> (ES) are a lightweight, scalable, gradient-free optimization technique. In the TorchCraftAI micro training, we use ES to optimize the weights of the micromanagement policy network.</p>
<p>Here's how ES works in the micro trainer:</p>
<ul>
<li>Initialize the policy network \(\theta\).</li>
<li>Randomly perturb the network weights. Here we use <a href="http://citeseerx.ist.psu.edu/viewdoc/download;jsessionid=A64D1AE8313A364B814998E9E245B40A?doi=10.1.1.180.7104&amp;rep=rep1&amp;type=pdf">antithetic sampling</a> to speed up convergence</li>
<li>Run episodes with the perturbed weights and measure the associated rewards.</li>
<li>Sort (rank) the rewards, then remap them to equally distributed values along [-0.5, 0.5].</li>
<li>Weigh the perturbations by the ranked-and-normalized reward.</li>
<li>Modify the network weights by the sum of the weighted perturbations.</li>
</ul>
<p>Mathematically, we do the following steps in a loop:</p>
<ol>
<li>Generate some noise vectors \(\delta_i\), where \(i=1, \ldots, n\). To do antithetic sampling, let's say \(\delta_{2i+1} = -\delta{2i}\).</li>
<li>Obtain the reward \(r_i\) for \(n\) battles using model \(\theta + \alpha \delta_i\). \(\alpha\) is <code>-sigma</code> in the codebase.</li>
<li>Calculate the reward transform, we use a rank transform like \(t(r_i) = \frac{\mathrm{rank}(r_i)}{n}\).</li>
<li>Find the parameter update, \(\theta \leftarrow \theta + \eta t(r_i) \delta_i\). \(\eta\) is the learning rate <code>-lr</code> in the codebase.</li>
</ol>
<p>The ES trainer itself is in <code>cpid/estrainer.cpp</code>. The hyperparameters are command flags specified in <code>flags.h</code>.</p>
<h2><a class="anchor" aria-hidden="true" id="reward-shaping"></a><a href="#reward-shaping" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reward Shaping</h2>
<p>Scenarios come with customizable reward functions specified in <code>reward.cpp</code>. We have found this formula effective:</p>
<p><code>Reward = (win=1, loss=0)/2 + (ratio of enemies killed)/4 + (ratio of friendly units surviving)/8 + ratio of enemy HP depleted)/16</code></p>
<p>This reward gives 0.5 for a win.
0.25 (1/4) is given proportionally according to the ratio of enemies killed.
0.125 (1/8) is given if all our units survive, and finally, 0.0625 (1/16) is given depending on the ratio of damage dealt to enemies.
This reward essentially tries to state that comparatively, two games that are both wins will break the tie in a way that encourages enemies killed, then allies surviving, then damage dealt.</p>
<p>By experimenting with the shapes in <code>reward.cpp</code> you may come up with something even better.</p>
<h2><a class="anchor" aria-hidden="true" id="results"></a><a href="#results" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Results</h2>
<p>We trained the default parameters on a variety of scenarios.
We took the model with the highest train-time reward, and tested it on 100 battles and recorded the win rates.
These numbers are not tuned at all, but could serve as an interesting baseline on how easy each of the scenarios are, or what you should expect to see from training.
You can also notice how the choice of opponents can greatly affect the results of training in that scenario.
The striking example is that the attack-weakest first heuristic does terribly in large battles, where as attack move is quite strong in most large battle settings - the difference between 100% and 0% winrate in most large battle scenarios.</p>
<p>Additionally, our initial tutorial provides plenty of space for improvement.
Many of these scenarios are not solved, though since they are mirror matches, they should be easy for the expert human.
We encourage you to play with the model and setup on these tasks, and see how far you can get!</p>
<p>The name of the scenario is the exact string to pass to <code>-scenario</code>.
Here are again the abbreviations we use:</p>
<ul>
<li>ar - Archon</li>
<li>bc - Battlecruiser</li>
<li>co - Corsair</li>
<li>de - Devourer</li>
<li>dn - Drone</li>
<li>dr - Dragoon</li>
<li>fi - Firebat</li>
<li>go - Goliath</li>
<li>hy - Hydralisk</li>
<li>it - Infested_Terran</li>
<li>mr - Marine</li>
<li>mu - Mutalisk</li>
<li>pr - Probe</li>
<li>sc - Scout</li>
<li>st - Siege_Tank_Tank_Mode</li>
<li>sv - SCV</li>
<li>ul - Ultralisk</li>
<li>vu - Vulture</li>
<li>wr - Wraith</li>
<li>zg - Zergling</li>
<li>zl - Zealot</li>
</ul>
<p>Here are the results of training our model on a variety of scenarios:</p>
<h3><a class="anchor" aria-hidden="true" id="symmetric-scenarios"></a><a href="#symmetric-scenarios" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Symmetric scenarios</h3>
<p>These are basicaly scenarios that are guaranteed to be balanced.
Several of the scenarios with 2 unit types rely on focus firing down one of the types first.</p>
<p><img src="/TorchCraftAI/docs/assets/go+bc.microtut.gif" alt="Goliaths and Battlecruisers"></p>
<table>
<thead>
<tr><th style="text-align:right">Test Win Rates</th><th style="text-align:center">weakest-closest</th><th style="text-align:center">closest</th><th style="text-align:center">attack-move</th></tr>
</thead>
<tbody>
<tr><td style="text-align:right">ar</td><td style="text-align:center">0.41</td><td style="text-align:center">0.50</td><td style="text-align:center">0.50</td></tr>
<tr><td style="text-align:right">ar+sc</td><td style="text-align:center">0.84</td><td style="text-align:center">0.86</td><td style="text-align:center">0.76</td></tr>
<tr><td style="text-align:right">bc</td><td style="text-align:center">0.36</td><td style="text-align:center">0.89</td><td style="text-align:center">0.75</td></tr>
<tr><td style="text-align:right">big_ar</td><td style="text-align:center">1.00</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">big_dr</td><td style="text-align:center">0.91</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">big_fb</td><td style="text-align:center">0.99</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">big_gh</td><td style="text-align:center">0.97</td><td style="text-align:center">0.19</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">big_go</td><td style="text-align:center">0.80</td><td style="text-align:center">0.00</td><td style="text-align:center">0.13</td></tr>
<tr><td style="text-align:right">big_hy</td><td style="text-align:center">1.00</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">big_it</td><td style="text-align:center">1.00</td><td style="text-align:center">1.00</td><td style="text-align:center">1.00</td></tr>
<tr><td style="text-align:right">big_mr</td><td style="text-align:center">0.93</td><td style="text-align:center">0.09</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">big_pr</td><td style="text-align:center">1.00</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">big_sv</td><td style="text-align:center">1.00</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">big_st</td><td style="text-align:center">0.93</td><td style="text-align:center">0.08</td><td style="text-align:center">0.29</td></tr>
<tr><td style="text-align:right">big_ul</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">big_vu</td><td style="text-align:center">1.00</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">big_wr</td><td style="text-align:center">1.00</td><td style="text-align:center">0.54</td><td style="text-align:center">0.08</td></tr>
<tr><td style="text-align:right">big_zg</td><td style="text-align:center">1.00</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">big_zl</td><td style="text-align:center">0.97</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">co</td><td style="text-align:center">0.28</td><td style="text-align:center">0.58</td><td style="text-align:center">0.52</td></tr>
<tr><td style="text-align:right">de</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">dn</td><td style="text-align:center">0.27</td><td style="text-align:center">0.22</td><td style="text-align:center">0.57</td></tr>
<tr><td style="text-align:right">dr</td><td style="text-align:center">0.45</td><td style="text-align:center">0.61</td><td style="text-align:center">0.48</td></tr>
<tr><td style="text-align:right">dr+sc</td><td style="text-align:center">0.20</td><td style="text-align:center">0.57</td><td style="text-align:center">0.61</td></tr>
<tr><td style="text-align:right">fi</td><td style="text-align:center">0.54</td><td style="text-align:center">0.24</td><td style="text-align:center">0.23</td></tr>
<tr><td style="text-align:right">go</td><td style="text-align:center">0.39</td><td style="text-align:center">0.72</td><td style="text-align:center">0.66</td></tr>
<tr><td style="text-align:right">go+bc</td><td style="text-align:center">0.99</td><td style="text-align:center">0.81</td><td style="text-align:center">0.89</td></tr>
<tr><td style="text-align:right">go+wr</td><td style="text-align:center">0.66</td><td style="text-align:center">0.63</td><td style="text-align:center">0.76</td></tr>
<tr><td style="text-align:right">hy</td><td style="text-align:center">0.43</td><td style="text-align:center">0.66</td><td style="text-align:center">0.65</td></tr>
<tr><td style="text-align:right">hy+mu</td><td style="text-align:center">0.19</td><td style="text-align:center">1.00</td><td style="text-align:center">0.93</td></tr>
<tr><td style="text-align:right">it</td><td style="text-align:center">0.99</td><td style="text-align:center">1.00</td><td style="text-align:center">1.00</td></tr>
<tr><td style="text-align:right">mr</td><td style="text-align:center">0.17</td><td style="text-align:center">0.33</td><td style="text-align:center">0.43</td></tr>
<tr><td style="text-align:right">mr+wr</td><td style="text-align:center">0.39</td><td style="text-align:center">0.61</td><td style="text-align:center">0.52</td></tr>
<tr><td style="text-align:right">mu</td><td style="text-align:center">0.28</td><td style="text-align:center">0.89</td><td style="text-align:center">0.91</td></tr>
<tr><td style="text-align:right">pr</td><td style="text-align:center">0.14</td><td style="text-align:center">0.33</td><td style="text-align:center">0.54</td></tr>
<tr><td style="text-align:right">sv</td><td style="text-align:center">0.29</td><td style="text-align:center">0.10</td><td style="text-align:center">0.42</td></tr>
<tr><td style="text-align:right">st</td><td style="text-align:center">0.45</td><td style="text-align:center">0.77</td><td style="text-align:center">0.56</td></tr>
<tr><td style="text-align:right">ul</td><td style="text-align:center">0.32</td><td style="text-align:center">0.57</td><td style="text-align:center">0.50</td></tr>
<tr><td style="text-align:right">vu</td><td style="text-align:center">0.22</td><td style="text-align:center">0.48</td><td style="text-align:center">0.67</td></tr>
<tr><td style="text-align:right">wr</td><td style="text-align:center">0.43</td><td style="text-align:center">0.49</td><td style="text-align:center">0.63</td></tr>
<tr><td style="text-align:right">xzl+ydr_xzl+ydr</td><td style="text-align:center">0.24</td><td style="text-align:center">0.08</td><td style="text-align:center">0.13</td></tr>
<tr><td style="text-align:right">zg</td><td style="text-align:center">0.20</td><td style="text-align:center">0.13</td><td style="text-align:center">0.28</td></tr>
<tr><td style="text-align:right">zl</td><td style="text-align:center">0.30</td><td style="text-align:center">0.29</td><td style="text-align:center">0.25</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="formation-based-scenarios"></a><a href="#formation-based-scenarios" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Formation based scenarios</h3>
<p>These formation based scenarios ideally involve the units grouping before fighting.
However, a few of them can achieve good winrrates with good focus fire.
Our model is not able to learn the regrouping tactic.</p>
<p><img src="/TorchCraftAI/docs/assets/conga_mu.microtut.gif" alt="Mutalisks"></p>
<table>
<thead>
<tr><th style="text-align:right">Test Win Rates</th><th style="text-align:center">weakest-closest</th><th style="text-align:center">closest</th><th style="text-align:center">attack-move</th></tr>
</thead>
<tbody>
<tr><td style="text-align:right">conga_ar</td><td style="text-align:center">0.47</td><td style="text-align:center">0.69</td><td style="text-align:center">0.03</td></tr>
<tr><td style="text-align:right">conga_dr</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td><td style="text-align:center">0.01</td></tr>
<tr><td style="text-align:right">conga_fb</td><td style="text-align:center">0.24</td><td style="text-align:center">0.11</td><td style="text-align:center">0.47</td></tr>
<tr><td style="text-align:right">conga_mr</td><td style="text-align:center">0.29</td><td style="text-align:center">0.43</td><td style="text-align:center">0.69</td></tr>
<tr><td style="text-align:right">conga_mu</td><td style="text-align:center">0.24</td><td style="text-align:center">0.99</td><td style="text-align:center">0.79</td></tr>
<tr><td style="text-align:right">conga_pr</td><td style="text-align:center">0.74</td><td style="text-align:center">0.01</td><td style="text-align:center">0.88</td></tr>
<tr><td style="text-align:right">conga_sv</td><td style="text-align:center">0.52</td><td style="text-align:center">0.00</td><td style="text-align:center">0.29</td></tr>
<tr><td style="text-align:right">conga_ul</td><td style="text-align:center">0.20</td><td style="text-align:center">0.09</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">conga_zg</td><td style="text-align:center">0.00</td><td style="text-align:center">0.03</td><td style="text-align:center">0.64</td></tr>
<tr><td style="text-align:right">conga_zl</td><td style="text-align:center">0.04</td><td style="text-align:center">0.04</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">surround_ar</td><td style="text-align:center">0.67</td><td style="text-align:center">0.53</td><td style="text-align:center">0.32</td></tr>
<tr><td style="text-align:right">surround_dr</td><td style="text-align:center">0.08</td><td style="text-align:center">0.01</td><td style="text-align:center">0.64</td></tr>
<tr><td style="text-align:right">surround_fb</td><td style="text-align:center">0.59</td><td style="text-align:center">0.22</td><td style="text-align:center">0.10</td></tr>
<tr><td style="text-align:right">surround_mu</td><td style="text-align:center">0.24</td><td style="text-align:center">0.85</td><td style="text-align:center">0.90</td></tr>
<tr><td style="text-align:right">surround_pr</td><td style="text-align:center">0.06</td><td style="text-align:center">0.01</td><td style="text-align:center">0.52</td></tr>
<tr><td style="text-align:right">surround_sv</td><td style="text-align:center">0.22</td><td style="text-align:center">0.01</td><td style="text-align:center">0.28</td></tr>
<tr><td style="text-align:right">surround_ul</td><td style="text-align:center">0.25</td><td style="text-align:center">0.04</td><td style="text-align:center">0.12</td></tr>
<tr><td style="text-align:right">surround_zg</td><td style="text-align:center">0.02</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">surround_zl</td><td style="text-align:center">0.12</td><td style="text-align:center">0.01</td><td style="text-align:center">0.05</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="asymmetric-scenarios"></a><a href="#asymmetric-scenarios" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Asymmetric scenarios</h3>
<p>Many of these scenarios rely on kiting to defeat a slower, melee ranged opponent.
A few rely on spreading units apart to avoid splash damage.</p>
<p><img src="/TorchCraftAI/docs/assets/10mu_5co.microtut.gif" alt="Mutalisks vs Corsairs"></p>
<p><img src="/TorchCraftAI/docs/assets/10mr_13zg.microtut.gif" alt="Marines vs Zerglings"></p>
<table>
<thead>
<tr><th style="text-align:right">Test Win Rates</th><th style="text-align:center">weakest-closest</th><th style="text-align:center">closest</th><th style="text-align:center">attack-move</th></tr>
</thead>
<tbody>
<tr><td style="text-align:right">10mr_13zg</td><td style="text-align:center">0.90</td><td style="text-align:center">0.90</td><td style="text-align:center">0.97</td></tr>
<tr><td style="text-align:right">10mu_5co</td><td style="text-align:center">0.90</td><td style="text-align:center">0.88</td><td style="text-align:center">0.92</td></tr>
<tr><td style="text-align:right">15mr_16mr</td><td style="text-align:center">0.06</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">15wr_17wr</td><td style="text-align:center">0.30</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">1dr_1zl</td><td style="text-align:center">1.00</td><td style="text-align:center">1.00</td><td style="text-align:center">1.00</td></tr>
<tr><td style="text-align:right">1dr_3zg</td><td style="text-align:center">0.31</td><td style="text-align:center">0.55</td><td style="text-align:center">0.75</td></tr>
<tr><td style="text-align:right">1go_2zl</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">1mu_3mr</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">1st_2zl</td><td style="text-align:center">0.96</td><td style="text-align:center">1.00</td><td style="text-align:center">0.95</td></tr>
<tr><td style="text-align:right">1vu_1hy</td><td style="text-align:center">0.76</td><td style="text-align:center">0.72</td><td style="text-align:center">0.93</td></tr>
<tr><td style="text-align:right">1vu_1zl</td><td style="text-align:center">1.00</td><td style="text-align:center">1.00</td><td style="text-align:center">0.98</td></tr>
<tr><td style="text-align:right">1vu_3zg</td><td style="text-align:center">0.97</td><td style="text-align:center">0.99</td><td style="text-align:center">0.95</td></tr>
<tr><td style="text-align:right">2dr+3zl_2dr+3zl</td><td style="text-align:center">0.46</td><td style="text-align:center">0.28</td><td style="text-align:center">0.50</td></tr>
<tr><td style="text-align:right">2dr_3zl</td><td style="text-align:center">0.66</td><td style="text-align:center">0.81</td><td style="text-align:center">0.14</td></tr>
<tr><td style="text-align:right">2hy_1sst</td><td style="text-align:center">1.00</td><td style="text-align:center">1.00</td><td style="text-align:center">1.00</td></tr>
<tr><td style="text-align:right">2mr_1zl</td><td style="text-align:center">0.03</td><td style="text-align:center">0.03</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">2vu_7zg</td><td style="text-align:center">0.98</td><td style="text-align:center">1.00</td><td style="text-align:center">0.92</td></tr>
<tr><td style="text-align:right">30zg_10zl</td><td style="text-align:center">1.00</td><td style="text-align:center">1.00</td><td style="text-align:center">1.00</td></tr>
<tr><td style="text-align:right">3dr_10zg</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">3go_8zl</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">3hy_2dr</td><td style="text-align:center">0.01</td><td style="text-align:center">0.10</td><td style="text-align:center">0.01</td></tr>
<tr><td style="text-align:right">3mr_3mr</td><td style="text-align:center">0.36</td><td style="text-align:center">0.64</td><td style="text-align:center">0.64</td></tr>
<tr><td style="text-align:right">3mu_9m3</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">3st_7zl</td><td style="text-align:center">0.56</td><td style="text-align:center">0.95</td><td style="text-align:center">0.89</td></tr>
<tr><td style="text-align:right">3vu_11zg</td><td style="text-align:center">0.97</td><td style="text-align:center">0.99</td><td style="text-align:center">0.99</td></tr>
<tr><td style="text-align:right">3vu_3hy</td><td style="text-align:center">0.56</td><td style="text-align:center">0.14</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">4hy_2sst</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">5mr_5mr</td><td style="text-align:center">0.34</td><td style="text-align:center">0.47</td><td style="text-align:center">0.45</td></tr>
<tr><td style="text-align:right">5mu+20zg_5gl+5vu</td><td style="text-align:center">0.93</td><td style="text-align:center">0.85</td><td style="text-align:center">0.75</td></tr>
<tr><td style="text-align:right">5vu_10zl</td><td style="text-align:center">0.04</td><td style="text-align:center">0.00</td><td style="text-align:center">0.01</td></tr>
<tr><td style="text-align:right">5wr_5wr</td><td style="text-align:center">0.39</td><td style="text-align:center">0.47</td><td style="text-align:center">0.76</td></tr>
<tr><td style="text-align:right">6mr_4zl</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">7zg_2gl</td><td style="text-align:center">0.00</td><td style="text-align:center">0.07</td><td style="text-align:center">0.13</td></tr>
<tr><td style="text-align:right">8mu_5co</td><td style="text-align:center">0.10</td><td style="text-align:center">0.21</td><td style="text-align:center">0.10</td></tr>
<tr><td style="text-align:right">vu_zl</td><td style="text-align:center">0.28</td><td style="text-align:center">0.35</td><td style="text-align:center">0.01</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="other-scenarios"></a><a href="#other-scenarios" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Other scenarios</h3>
<p>These scenarios do not involve combat.
The rewards are specifically tailored to the scenario.
In all of the <code>hug*</code> scenarios, the reward is negative distance.
In popoverlords, the reward is -1 for how long it took to kill all overlords.
In ignorecivilians, the reward is 1 for a perfect success, and between 0-1 for each civilian we kill.
We can see the model focuses the high templar, but isn't able to learn to completely ignore all civilians.
One tactic we observed is that the model would oscillate between two civilians so it never managed to kill any.</p>
<p><img src="/TorchCraftAI/docs/assets/ignorecivilians.microtut.gif" alt="Ignore civilians"></p>
<table>
<thead>
<tr><th style="text-align:right">Scenario</th><th style="text-align:center">Test reward</th></tr>
</thead>
<tbody>
<tr><td style="text-align:right">hugmiddle</td><td style="text-align:center">-21.24</td></tr>
<tr><td style="text-align:right">hugmiddleeasy</td><td style="text-align:center">0.00</td></tr>
<tr><td style="text-align:right">hugoverlords</td><td style="text-align:center">-37.18</td></tr>
<tr><td style="text-align:right">ignorecivilians</td><td style="text-align:center">0.88</td></tr>
<tr><td style="text-align:right">popoverlords</td><td style="text-align:center">-5986.96</td></tr>
</tbody>
</table>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/TorchCraftAI/docs/microtut-model.html"><span class="arrow-prev">← </span><span>Model</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#evolution-strategies">Evolution Strategies</a></li><li><a href="#reward-shaping">Reward Shaping</a></li><li><a href="#results">Results</a><ul class="toc-headings"><li><a href="#symmetric-scenarios">Symmetric scenarios</a></li><li><a href="#formation-based-scenarios">Formation based scenarios</a></li><li><a href="#asymmetric-scenarios">Asymmetric scenarios</a></li><li><a href="#other-scenarios">Other scenarios</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/TorchCraftAI/" class="nav-home"><img src="/TorchCraftAI/img/tclogosqsmall.png" alt="TorchCraftAI" width="66" height="58"/></a><div><h5>Docs</h5><a href="/TorchCraftAI/docs/en/install-linux.html">Getting Started (Linux)</a><a href="/TorchCraftAI/docs/en/install-windows.html">Getting Started (Windows)</a><a href="/TorchCraftAI/docs/en/install-macos.html">Getting Started (Mac)</a><a href="reference/index.html">API Reference</a></div><div><h5>Community</h5><a href="https://discordapp.com/invite/w9wRRrF">Starcraft AI Discord</a><a href="https://www.facebook.com/groups/bwapi/">Starcraft AI Facebook group</a><a href="https://github.com/TorchCraft/TorchCraftAI">TorchCraftAI on GitHub</a></div><div><h5>More</h5><a href="https://github.com/TorchCraft/TorchCraft">TorchCraft on GitHub</a><a href="https://github.com/TorchCraft/StarData">StarData on GitHub</a><a href="/TorchCraftAI/blog">Blog</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/TorchCraftAI/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2019 Facebook</section></footer></div></body></html>